---
crowdsec:
  service: "crowdsec"

  # Image + Tag
  image: "crowdsecurity/crowdsec:latest"

  path: "{{ docker.base_dir }}/crowdsec"

  # Collections to install
  collections:
    - crowdsecurity/linux
    - crowdsecurity/sshd
    - crowdsecurity/caddy
    - crowdsecurity/http-cve

  # Whitelist (self)
  whitelists:
    - "127.0.0.1"
    - "::1"

  # API Config
  api:
    port: 8080

  # Secrets (Vault)
  bouncer_key: "{{ vault_crowdsec.bouncer_key }}"

  # Resources
  memory: "512M"

  # Integration
  autoheal: true

  # Log Source Paths
  logs:
    system_auth: "/var/log/auth.log"
    system_syslog: "/var/log/syslog"
    caddy: "{{ docker.base_dir }}/caddy/logs"

  # Healthcheck (Heavy startup)
  healthcheck:
    interval: "60s"
    timeout: "30s"
    retries: 3
    start_period: "120s"
