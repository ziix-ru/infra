[global]
server_name = "{{ matrix_server_name }}"
database_backend = "{{ matrix_database_backend }}"
database_path = "/var/lib/matrix-conduit/"
port = {{ matrix_port }}
max_request_size = {{ matrix_max_request_size }}
allow_registration = {{ matrix_registration_enabled | lower }}
yes_i_am_very_very_sure_i_want_an_open_registration_server_prone_to_abuse = true
allow_federation = {{ matrix_allow_federation | lower }}
trusted_servers = {{ matrix_trusted_servers }}
address = "0.0.0.0"
log = "info"

# ВАЖНО: Tuwunel сам отдает well-known server
[global.well_known]
server = "{{ matrix_well_known_server }}"
client = "{{ matrix_well_known_client }}"

# ВАЖНО: Tuwunel сам отдает RTC конфиг (вместо Nginx)
[[global.well_known.rtc_transports]]
type = "livekit"
livekit_service_url = "wss://{{ rtc_domain }}"

# TURN - массивом, как положено в TOML
turn_uris = {{ matrix_turn_uris }}
turn_secret = "{{ matrix_turn_secret }}"
